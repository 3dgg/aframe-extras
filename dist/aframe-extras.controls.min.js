!function e(t,o,n){function i(a,c){if(!o[a]){if(!t[a]){var r="function"==typeof require&&require;if(!c&&r)return r(a,!0);if(s)return s(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var h=o[a]={exports:{}};t[a][0].call(h.exports,function(e){var o=t[a][1][e];return i(o?o:e)},h,h.exports,e,t,o,n)}return o[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,o){e("./src/controls").registerAll()},{"./src/controls":8}],2:[function(e,t,o){t.exports=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16})},{}],3:[function(e,t,o){function n(e,t,o){this.type=e,this.index=t,this.pressed=o.pressed,this.value=o.value}t.exports=n},{}],4:[function(e,t,o){!function(e){function t(e,t){return-1!==String(e).indexOf(t)}function o(e,t,o){y!==t&&u!==t&&l!==t||Object.keys(o).forEach(function(t){e[t]=o[t]})}function n(e,t){var o={};return Object.keys(e).forEach(function(n){var i=e[n];t in i&&(o[i[t]]=i)}),o}function i(e){var t="keyCode"in e?e.keyCode:"which"in e?e.which:0,o=function(){if(g||"keyLocation"in e){var o=g?e.location:e.keyLocation;if(o&&t in f[o])return f[o][t]}return"keyIdentifier"in e&&e.keyIdentifier in m?m[e.keyIdentifier]:t in p?p[t]:null}();if(!o)return null;var n=function(){var t=k[o.code];return t?e.shiftKey&&"shiftKey"in t?t.shiftKey:t.key:o.code}();return{code:o.code,key:n,location:o.location,keyCap:o.keyCap}}function s(e,t){if(e=String(e),!E.hasOwnProperty(e))return"Undefined";if(t&&"en-us"!==String(t).toLowerCase())throw Error("Unsupported locale");var o=E[e];return o.keyCap||o.code||"Undefined"}var a="KeyboardEvent"in e;a||(e.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),e.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0,e.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1,e.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2,e.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3;var c=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,r=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,d=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,h=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD,l=function(){return t(navigator.platform,"Win")?"win":t(navigator.platform,"Mac")?"mac":t(navigator.platform,"CrOS")?"cros":t(navigator.platform,"Linux")?"linux":t(navigator.userAgent,"iPad")||t(navigator.platform,"iPod")||t(navigator.platform,"iPhone")?"ios":""}(),u=function(){return t(navigator.userAgent,"Chrome/")?"chrome":t(navigator.vendor,"Apple")?"safari":t(navigator.userAgent,"MSIE")?"ie":t(navigator.userAgent,"Gecko/")?"moz":t(navigator.userAgent,"Opera/")?"opera":""}(),y=u+"-"+l,p={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:r},92:{code:"OSRight",location:d},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:h},97:{code:"Numpad1",keyCap:"1",location:h},98:{code:"Numpad2",keyCap:"2",location:h},99:{code:"Numpad3",keyCap:"3",location:h},100:{code:"Numpad4",keyCap:"4",location:h},101:{code:"Numpad5",keyCap:"5",location:h},102:{code:"Numpad6",keyCap:"6",location:h},103:{code:"Numpad7",keyCap:"7",location:h},104:{code:"Numpad8",keyCap:"8",location:h},105:{code:"Numpad9",keyCap:"9",location:h},106:{code:"NumpadMultiply",keyCap:"*",location:h},107:{code:"NumpadAdd",keyCap:"+",location:h},108:{code:"NumpadComma",keyCap:",",location:h},109:{code:"NumpadSubtract",keyCap:"-",location:h},110:{code:"NumpadDecimal",keyCap:".",location:h},111:{code:"NumpadDivide",keyCap:"/",location:h},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:h},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:r},161:{code:"ShiftRight",location:d},162:{code:"ControlLeft",location:r},163:{code:"ControlRight",location:d},164:{code:"AltLeft",location:r},165:{code:"AltRight",location:d},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};o(p,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:h},189:{code:"NumpadSubtract",keyCap:"-",location:h}}),o(p,"moz-mac",{12:{code:"NumLock",location:h},173:{code:"Minus",keyCap:"-"}}),o(p,"moz-win",{173:{code:"Minus",keyCap:"-"}}),o(p,"chrome-mac",{93:{code:"OSRight",location:d}}),o(p,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),o(p,"ios",{10:{code:"Enter",location:c}}),o(p,"safari-mac",{91:{code:"OSLeft",location:r},93:{code:"OSRight",location:d},229:{code:"KeyQ",keyCap:"Q"}});var m={};"cros"===l&&(m["U+00A0"]={code:"ShiftLeft",location:r},m["U+00A1"]={code:"ShiftRight",location:d},m["U+00A2"]={code:"ControlLeft",location:r},m["U+00A3"]={code:"ControlRight",location:d},m["U+00A4"]={code:"AltLeft",location:r},m["U+00A5"]={code:"AltRight",location:d}),"chrome-mac"===y&&(m["U+0010"]={code:"ContextMenu"}),"safari-mac"===y&&(m["U+0010"]={code:"ContextMenu"}),"ios"===l&&(m["U+0010"]={code:"Function"},m["U+001C"]={code:"ArrowLeft"},m["U+001D"]={code:"ArrowRight"},m["U+001E"]={code:"ArrowUp"},m["U+001F"]={code:"ArrowDown"},m["U+0001"]={code:"Home"},m["U+0004"]={code:"End"},m["U+000B"]={code:"PageUp"},m["U+000C"]={code:"PageDown"});var f=[];f[r]={16:{code:"ShiftLeft",location:r},17:{code:"ControlLeft",location:r},18:{code:"AltLeft",location:r}},f[d]={16:{code:"ShiftRight",location:d},17:{code:"ControlRight",location:d},18:{code:"AltRight",location:d}},f[h]={13:{code:"NumpadEnter",location:h}},o(f[h],"moz",{109:{code:"NumpadSubtract",location:h},107:{code:"NumpadAdd",location:h}}),o(f[r],"moz-mac",{224:{code:"OSLeft",location:r}}),o(f[d],"moz-mac",{224:{code:"OSRight",location:d}}),o(f[d],"moz-win",{91:{code:"OSRight",location:d}}),o(f[d],"mac",{93:{code:"OSRight",location:d}}),o(f[h],"chrome-mac",{12:{code:"NumLock",location:h}}),o(f[h],"safari-mac",{12:{code:"NumLock",location:h},187:{code:"NumpadAdd",location:h},189:{code:"NumpadSubtract",location:h},190:{code:"NumpadDecimal",location:h},191:{code:"NumpadDivide",location:h}});var k={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};o(k,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var v={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},E=n(p,"code");try{var g=a&&"location"in new KeyboardEvent("")}catch(C){}"KeyboardEvent"in e&&"defineProperty"in Object&&!function(){function e(e,t,o){t in e||Object.defineProperty(e,t,o)}if(e(KeyboardEvent.prototype,"code",{get:function(){var e=i(this);return e?e.code:""}}),"key"in KeyboardEvent.prototype){var t=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var e=t.get.call(this);return v.hasOwnProperty(e)?v[e]:e}})}e(KeyboardEvent.prototype,"key",{get:function(){var e=i(this);return e&&"key"in e?e.key:"Unidentified"}}),e(KeyboardEvent.prototype,"location",{get:function(){var e=i(this);return e&&"location"in e?e.location:c}}),e(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in e.KeyboardEvent||(e.KeyboardEvent.queryKeyCap=s),e.identifyKey=function(e){if(!("code"in e)){var t=i(e);e.code=t?t.code:"",e.key=t&&"key"in t?t.key:"Unidentified",e.location="location"in e?e.location:"keyLocation"in e?e.keyLocation:t&&"location"in t?t.location:c,e.locale=""}}}(window)},{}],5:[function(e,t,o){var n=.1;t.exports={schema:{enabled:{"default":!0},mode:{"default":"teleport",oneOf:["teleport","animate"]},animateSpeed:{"default":3}},init:function(){this.active=!0,this.checkpoint=null,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(e){this.active&&(this.checkpoint=e,"teleport"===this.data.mode&&(this.sync(),this.el.setAttribute("position",this.targetPosition)))},isVelocityActive:function(){return!(!this.active||!this.checkpoint)},getVelocity:function(){if(this.active){var e=this.data,t=this.offset,o=this.position,i=this.targetPosition;return this.sync(),o.distanceTo(i)<n?(this.checkpoint=null,t.set(0,0,0)):(t.setLength(e.animateSpeed),t)}},sync:function(){var e=this.offset,t=this.position,o=this.targetPosition;t.copy(this.el.getComputedAttribute("position")),o.copy(this.checkpoint.getComputedAttribute("position")),o.y=t.y,e.copy(o).sub(t)}}},{}],6:[function(e,t,o){var n=e("../../lib/GamepadButton"),i=e("../../lib/GamepadButtonEvent"),s=.2;t.exports={GamepadButton:n,schema:{controller:{"default":0,oneOf:[0,1,2,3]},enabled:{"default":!0},debug:{"default":!1}},init:function(){var e=this.el.sceneEl;this.prevTime=window.performance.now(),this.buttons={},e.addBehavior(this),this.getGamepad()||console.warn("Gamepad #%d not found. Connect controller and press any button to continue.",this.data.controller)},update:function(){this.tick()},tick:function(){this.updateButtonState()},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;var e=this.getDpad(),t=this.getJoystick(0),o=e.x||t.x,n=e.y||t.y;return Math.abs(o)>s||Math.abs(n)>s},getVelocityDelta:function(){var e=this.getDpad(),t=this.getJoystick(0),o=e.x||t.x,n=e.y||t.y,i=new THREE.Vector3;return Math.abs(o)>s&&(i.x+=o),Math.abs(n)>s&&(i.z+=n),i},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;var e=this.getJoystick(1);return Math.abs(e.x)>s||Math.abs(e.y)>s},getRotationDelta:function(){var e=this.getJoystick(1);return Math.abs(e.x)<=s&&(e.x=0),Math.abs(e.y)<=s&&(e.y=0),e},updateButtonState:function(){var e=this.getGamepad();if(this.data.enabled&&e)for(var t=0;t<e.buttons.length;t++)e.buttons[t].pressed&&!this.buttons[t]?this.emit(new i("gamepadbuttondown",t,e.buttons[t])):!e.buttons[t].pressed&&this.buttons[t]&&this.emit(new i("gamepadbuttonup",t,e.buttons[t])),this.buttons[t]=e.buttons[t].pressed;else Object.keys(this.buttons)&&(this.buttons={})},emit:function(e){this.el.emit(e.type,e),this.el.emit(e.type+":"+e.index,new i(e.type,e.index,e))},getGamepad:function(){var e=navigator.getGamepads&&navigator.getGamepads()[this.data.controller],t=this.el.sceneEl.components["proxy-controls"],o=t&&t.isConnected()&&t.getGamepad(this.data.controller);return o||e},getButton:function(e){return this.getGamepad().buttons[e]},getAxis:function(e){return this.getGamepad().axes[e]},getJoystick:function(e){var t=this.getGamepad();switch(e){case 0:return new THREE.Vector2(t.axes[0],t.axes[1]);case 1:return new THREE.Vector2(t.axes[2],t.axes[3]);default:throw new Error('Unexpected joystick index "%d".',e)}},getDpad:function(){var e=this.getGamepad();return e.buttons[n.DPAD_RIGHT]?new THREE.Vector2((e.buttons[n.DPAD_RIGHT].pressed?1:0)+(e.buttons[n.DPAD_LEFT].pressed?-1:0),(e.buttons[n.DPAD_UP].pressed?-1:0)+(e.buttons[n.DPAD_DOWN].pressed?1:0)):new THREE.Vector2},isConnected:function(){var e=this.getGamepad();return!(!e||!e.connected)},getID:function(){return this.getGamepad().id}}},{"../../lib/GamepadButton":2,"../../lib/GamepadButtonEvent":3}],7:[function(e,t,o){var n=4;t.exports={schema:{enabled:{"default":!0}},init:function(){this.tPrev=0,this.dolly=new THREE.Object3D,this.euler=new THREE.Euler,this.controls=new THREE.VRControls(this.dolly),this.zeroQuaternion=new THREE.Quaternion},tick:function(e){e=e||Date.now(),e-this.tPrev>n&&(this.controls.update(),this.tPrev=e)},isRotationActive:function(){return this.data.enabled&&!this.dolly.quaternion.equals(this.zeroQuaternion)},getRotation:function(){var e=new THREE.Euler;return e.order="YXZ",function(){this.tick();var t=this.calculateHMDQuaternion();return e.setFromQuaternion(t),new THREE.Vector3(THREE.Math.radToDeg(e.x),THREE.Math.radToDeg(e.y),THREE.Math.radToDeg(e.z))}}(),calculateHMDQuaternion:function(){var e=new THREE.Quaternion;return function(){var t=this.dolly;return this.zeroed||t.quaternion.equals(this.zeroQuaternion)||(this.zeroOrientation(),this.zeroed=!0),e.copy(this.zeroQuaternion).multiply(t.quaternion),e}}(),zeroOrientation:function(){var e=new THREE.Euler;e.setFromQuaternion(this.dolly.quaternion.clone().inverse()),e.z=0,e.x=0,this.zeroQuaternion.setFromEuler(e)}}},{}],8:[function(e,t,o){var n=e("../math");t.exports={"checkpoint-controls":e("./checkpoint-controls"),"gamepad-controls":e("./gamepad-controls"),"hmd-controls":e("./hmd-controls"),"keyboard-controls":e("./keyboard-controls"),"mouse-controls":e("./mouse-controls"),"touch-controls":e("./touch-controls"),"universal-controls":e("./universal-controls"),registerAll:function(e){this._registered||(e=e||window.AFRAME,e=e.aframeCore||e,n.registerAll(),e.components["checkpoint-controls"]||e.registerComponent("checkpoint-controls",this["checkpoint-controls"]),e.components["gamepad-controls"]||e.registerComponent("gamepad-controls",this["gamepad-controls"]),e.components["hmd-controls"]||e.registerComponent("hmd-controls",this["hmd-controls"]),e.components["keyboard-controls"]||e.registerComponent("keyboard-controls",this["keyboard-controls"]),e.components["mouse-controls"]||e.registerComponent("mouse-controls",this["mouse-controls"]),e.components["touch-controls"]||e.registerComponent("touch-controls",this["touch-controls"]),e.components["universal-controls"]||e.registerComponent("universal-controls",this["universal-controls"]),this._registered=!0)}}},{"../math":13,"./checkpoint-controls":5,"./gamepad-controls":6,"./hmd-controls":7,"./keyboard-controls":9,"./mouse-controls":10,"./touch-controls":11,"./universal-controls":12}],9:[function(e,t,o){e("../../lib/keyboard.polyfill");var n="__keyboard-controls-proxy",i=window.KeyboardEvent;t.exports={schema:{enabled:{"default":!0},debug:{"default":!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this)},this.attachEventListeners()},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){var e=this.data,t=this.getKeys();return this.dVelocity.set(0,0,0),e.enabled&&((t.KeyW||t.ArrowUp)&&(this.dVelocity.z-=1),(t.KeyA||t.ArrowLeft)&&(this.dVelocity.x-=1),(t.KeyS||t.ArrowDown)&&(this.dVelocity.z+=1),(t.KeyD||t.ArrowRight)&&(this.dVelocity.x+=1)),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.pause()},attachEventListeners:function(){window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(e){this.localKeys[e.code]=!0,this.emit(e)},onKeyUp:function(e){delete this.localKeys[e.code],this.emit(e)},onBlur:function(){for(var e in this.localKeys)this.localKeys.hasOwnProperty(e)&&delete this.localKeys[e]},emit:function(e){n in e&&this.el.emit(e.type,e),this.el.emit(e.type+":"+e.code,new i(e.type,e)),this.data.debug&&console.log(e.type+":"+e.code)},isPressed:function(e){return e in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){var e=this.el.sceneEl.components["proxy-controls"];return e&&e.isConnected()}}},{"../../lib/keyboard.polyfill":4}],10:[function(e,t,o){t.exports={schema:{enabled:{"default":!0},pointerlockEnabled:{"default":!0},sensitivity:{"default":.04}},init:function(){this.mouseDown=!1,this.pointerLocked=!1,this.lookVector=new THREE.Vector2,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.lookVector.set(0,0)},remove:function(){this.pause()},bindMethods:function(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this)},addEventListeners:function(){var e=this.el.sceneEl,t=e.canvas,o=this.data;return t?(t.addEventListener("mousedown",this.onMouseDown,!1),t.addEventListener("mousemove",this.onMouseMove,!1),t.addEventListener("mouseup",this.onMouseUp,!1),t.addEventListener("mouseout",this.onMouseUp,!1),void(o.pointerlockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1)))):void e.addEventListener("render-target-loaded",this.addEventListeners.bind(this))},removeEventListeners:function(){var e=this.el.sceneEl&&this.sceneEl.canvas;e&&(e.removeEventListener("mousedown",this.onMouseDown,!1),e.removeEventListener("mousemove",this.onMouseMove,!1),e.removeEventListener("mouseup",this.onMouseUp,!1),e.removeEventListener("mouseout",this.onMouseUp,!1)),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1)},isRotationActive:function(){return this.data.enabled&&(this.mouseDown||this.pointerLocked)},getRotationDelta:function(){var e=this.lookVector.clone().multiplyScalar(this.data.sensitivity);return this.lookVector.set(0,0),e},onMouseMove:function(e){var t=this.previousMouseEvent;if(this.data.enabled&&(this.mouseDown||this.pointerLocked)){var o=e.movementX||e.mozMovementX||0,n=e.movementY||e.mozMovementY||0;this.pointerLocked||(o=e.screenX-t.screenX,n=e.screenY-t.screenY),this.lookVector.x+=o,this.lookVector.y+=n,this.previousMouseEvent=e}},onMouseDown:function(e){var t=this.el.sceneEl.canvas;this.mouseDown=!0,this.previousMouseEvent=e,this.data.pointerlockEnabled&&!this.pointerLocked&&(t.requestPointerLock?t.requestPointerLock():t.mozRequestPointerLock&&t.mozRequestPointerLock())},onMouseUp:function(){this.mouseDown=!1},onPointerLockChange:function(){this.pointerLocked=!(!document.pointerLockElement&&!document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1}}},{}],11:[function(e,t,o){t.exports={schema:{enabled:{"default":!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){var e=this.el.sceneEl,t=e.canvas;return t?(t.addEventListener("touchstart",this.onTouchStart),void t.addEventListener("touchend",this.onTouchEnd)):void e.addEventListener("render-target-loaded",this.addEventListeners.bind(this))},removeEventListeners:function(){var e=this.el.sceneEl&&this.sceneEl.canvas;e&&(e.removeEventListener("touchstart",this.onTouchStart),e.removeEventListener("touchend",this.onTouchEnd))},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-1:0,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this)},onTouchStart:function(e){this.isMoving=!0,e.preventDefault()},onTouchEnd:function(e){this.isMoving=!1,e.preventDefault()}}},{}],12:[function(e,t,o){var n="-controls",i=.2,s=Math.PI/2;t.exports={dependencies:["velocity","rotation"],schema:{enabled:{"default":!0},movementEnabled:{"default":!0},movementControls:{"default":["gamepad","keyboard","touch"]},rotationEnabled:{"default":!0},rotationControls:{"default":["hmd","gamepad","mouse"]},movementSpeed:{"default":5},movementEasing:{"default":15},movementAcceleration:{"default":80},rotationSensitivity:{"default":.05}},init:function(){this.velocity=new THREE.Vector3,this.pitch=new THREE.Object3D,this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.add(this.pitch),this.heading=new THREE.Euler(0,0,0,"YXZ"),this.el.sceneEl.hasLoaded?this.injectControls():this.el.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(){this.el.sceneEl.hasLoaded&&this.injectControls()},injectControls:function(){var e,t,o=this.data;for(e=0;e<o.movementControls.length;e++)t=o.movementControls[e]+n,this.el.components[t]||this.el.setAttribute(t,"");for(e=0;e<o.rotationControls.length;e++)t=o.rotationControls[e]+n,this.el.components[t]||this.el.setAttribute(t,"")},tick:function(e,t){isNaN(t)||(this.data.rotationEnabled&&this.updateRotation(t),this.data.movementEnabled&&t/1e3>i?(this.velocity.set(0,0,0),this.el.setAttribute("velocity",this.velocity)):this.data.movementEnabled&&this.updateVelocity(t))},updateRotation:function(e){for(var t,o,i=this.data,a=0,c=i.rotationControls.length;c>a;a++)if(t=this.el.components[i.rotationControls[a]+n],t&&t.isRotationActive()){if(t.getRotationDelta)o=t.getRotationDelta(e),o.multiplyScalar(i.rotationSensitivity),this.yaw.rotation.y-=o.x,this.pitch.rotation.x-=o.y,this.pitch.rotation.x=Math.max(-s,Math.min(s,this.pitch.rotation.x)),this.el.setAttribute("rotation",{x:THREE.Math.radToDeg(this.pitch.rotation.x),y:THREE.Math.radToDeg(this.yaw.rotation.y),z:0});else{if(!t.getRotation)throw new Error("Incompatible rotation controls: %s",i.rotationControls[a]);this.el.setAttribute("rotation",t.getRotation())}break}},updateVelocity:function(e){for(var t,o,i,s=this.data,a=0,c=s.movementControls.length;c>a;a++)if(t=this.el.components[s.movementControls[a]+n],t&&t.isVelocityActive()){if(!t.getVelocityDelta){if(t.getVelocity)return void this.el.setAttribute("velocity",t.getVelocity());throw new Error("Incompatible movement controls: ",s.movementControls[a])}i=t.getVelocityDelta(e);break}if(o=this.velocity,o.copy(this.el.getAttribute("velocity")),o.x-=o.x*s.movementEasing*e/1e3,o.z-=o.z*s.movementEasing*e/1e3,i){i.length()>1?i.setLength(this.data.movementAcceleration*e/1e3):i.multiplyScalar(this.data.movementAcceleration*e/1e3);var r=this.el.getAttribute("rotation");r&&(this.heading.set(0,THREE.Math.degToRad(r.y),0),i.applyEuler(this.heading)),o.add(i)}this.el.setAttribute("velocity",o)}}},{}],13:[function(e,t,o){t.exports={velocity:e("./velocity"),quaternion:e("./quaternion"),registerAll:function(e){this._registered||(e=e||window.AFRAME,e=e.aframeCore||e,e.components.velocity||e.registerComponent("velocity",this.velocity),e.components.quaternion||e.registerComponent("quaternion",this.quaternion),this._registered=!0)}}},{"./quaternion":14,"./velocity":15}],14:[function(e,t,o){t.exports={schema:{type:"vec4"},tick:function(){var e=this.data;this.el.object3D.quaternion.set(e.x,e.y,e.z,e.w)}}},{}],15:[function(e,t,o){t.exports={schema:{type:"vec3"},init:function(){this.system=this.el.sceneEl.systems.physics,this.system&&this.system.addBehavior(this,this.system.Phase.RENDER)},remove:function(){this.system&&this.system.removeBehavior(this,this.system.Phase.RENDER)},tick:function(e,t){isNaN(t)||this.system||this.step(e,t)},step:function(e,t){if(!isNaN(t)){var o=this.el.sceneEl.systems.physics||{options:{maxInterval:1/60}},n=this.el.getAttribute("velocity"),i=this.el.getAttribute("position");t=Math.min(t,1e3*o.options.maxInterval),this.el.setAttribute("position",{x:i.x+n.x*t/1e3,y:i.y+n.y*t/1e3,z:i.z+n.z*t/1e3})}}}},{}]},{},[1]);