!function e(t,n,i){function o(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var m=n[s]={exports:{}};t[s][0].call(m.exports,function(e){var n=t[s][1][e];return o(n?n:e)},m,m.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t,n){e("./src/loaders").registerAll()},{"./src/loaders":4}],2:[function(e,t,n){t.exports=THREE.PLYLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.propertyNameMapping={}},THREE.PLYLoader.prototype={constructor:THREE.PLYLoader,load:function(e,t,n,i){var o=this,r=new THREE.XHRLoader(this.manager);r.setResponseType("arraybuffer"),r.load(e,function(e){t(o.parse(e))},n,i)},setPropertyNameMapping:function(e){this.propertyNameMapping=e},bin2str:function(e){for(var t=new Uint8Array(e),n="",i=0;i<e.byteLength;i++)n+=String.fromCharCode(t[i]);return n},isASCII:function(e){var t=this.parseHeader(this.bin2str(e));return"ascii"===t.format},parse:function(e){return e instanceof ArrayBuffer?this.isASCII(e)?this.parseASCII(this.bin2str(e)):this.parseBinary(e):this.parseASCII(e)},parseHeader:function(e){function t(e,t){var n={type:e[0]};return"list"===n.type?(n.name=e[3],n.countType=e[1],n.itemType=e[2]):n.name=e[1],n.name in t&&(n.name=t[n.name]),n}var n=/ply([\s\S]*)end_header\s/,i="",o=0,r=n.exec(e);null!==r&&(i=r[1],o=r[0].length);for(var s,a,l={comments:[],elements:[],headerLength:o},c=i.split("\n"),m=void 0,h=0;h<c.length;h++){var d=c[h];if(d=d.trim(),""!==d)switch(a=d.split(/\s+/),s=a.shift(),d=a.join(" "),s){case"format":l.format=a[0],l.version=a[1];break;case"comment":l.comments.push(d);break;case"element":void 0!==m&&l.elements.push(m),m=Object(),m.name=a[0],m.count=parseInt(a[1]),m.properties=[];break;case"property":m.properties.push(t(a,this.propertyNameMapping));break;default:console.log("unhandled",s,a)}}return void 0!==m&&l.elements.push(m),l},parseASCIINumber:function(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}},parseASCIIElement:function(e,t){for(var n=t.split(/\s+/),i=Object(),o=0;o<e.length;o++)if("list"===e[o].type){for(var r=[],s=this.parseASCIINumber(n.shift(),e[o].countType),a=0;a<s;a++)r.push(this.parseASCIINumber(n.shift(),e[o].itemType));i[e[o].name]=r}else i[e[o].name]=this.parseASCIINumber(n.shift(),e[o].type);return i},parseASCII:function(e){var t,n=new THREE.Geometry,i=this.parseHeader(e),o=/end_header\s([\s\S]*)$/,r="";null!==(t=o.exec(e))&&(r=t[1]);var s=r.split("\n"),a=0,l=0;n.useColor=!1;for(var c=0;c<s.length;c++){var m=s[c];if(m=m.trim(),""!==m){l>=i.elements[a].count&&(a++,l=0);var h=this.parseASCIIElement(i.elements[a].properties,m);this.handleElement(n,i.elements[a].name,h),l++}}return this.postProcess(n)},postProcess:function(e){if(e.useColor){for(var t=0;t<e.faces.length;t++)e.faces[t].vertexColors=[e.colors[e.faces[t].a],e.colors[e.faces[t].b],e.colors[e.faces[t].c]];e.elementsNeedUpdate=!0}return e.computeBoundingSphere(),e},handleElement:function(e,t,n){if("vertex"===t){if(e.vertices.push(new THREE.Vector3(n.x,n.y,n.z)),"red"in n&&"green"in n&&"blue"in n){e.useColor=!0;var i=new THREE.Color;i.setRGB(n.red/255,n.green/255,n.blue/255),e.colors.push(i)}}else if("face"===t){var o=n.vertex_indices||n.vertex_index;3===o.length?e.faces.push(new THREE.Face3(o[0],o[1],o[2])):4===o.length&&e.faces.push(new THREE.Face3(o[0],o[1],o[3]),new THREE.Face3(o[1],o[2],o[3]))}},binaryRead:function(e,t,n,i){switch(n){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,i),2];case"uint16":case"ushort":return[e.getUint16(t,i),2];case"int32":case"int":return[e.getInt32(t,i),4];case"uint32":case"uint":return[e.getUint32(t,i),4];case"float32":case"float":return[e.getFloat32(t,i),4];case"float64":case"double":return[e.getFloat64(t,i),8]}},binaryReadElement:function(e,t,n,i){for(var o,r=Object(),s=0,a=0;a<n.length;a++)if("list"===n[a].type){var l=[];o=this.binaryRead(e,t+s,n[a].countType,i);var c=o[0];s+=o[1];for(var m=0;m<c;m++)o=this.binaryRead(e,t+s,n[a].itemType,i),l.push(o[0]),s+=o[1];r[n[a].name]=l}else o=this.binaryRead(e,t+s,n[a].type,i),r[n[a].name]=o[0],s+=o[1];return[r,s]},parseBinary:function(e){for(var t,n=new THREE.Geometry,i=this.parseHeader(this.bin2str(e)),o="binary_little_endian"===i.format,r=new DataView(e,i.headerLength),s=0,a=0;a<i.elements.length;a++)for(var l=0;l<i.elements[a].count;l++){t=this.binaryReadElement(r,s,i.elements[a].properties,o),s+=t[1];var c=t[0];this.handleElement(n,i.elements[a].name,c)}return this.postProcess(n)}}},{}],3:[function(e,t,n){var i="__auto__";t.exports={schema:{clip:{"default":i},duration:{"default":0}},init:function(){this.model=null,this.mixer=null,this.activeAction=null;var e=this.el.getObject3D("mesh");e?this.load(e):this.el.addEventListener("model-loaded",function(e){this.load(e.detail.model)}.bind(this))},load:function(e){this.model=e,this.mixer=new THREE.AnimationMixer(e),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(e){if(e){var t=this.data;t.clip!==e.clip&&(this.activeAction&&this.activeAction.stop(),t.clip&&this.playClip(t.clip)),this.activeAction&&t.duration&&this.activeAction.setDuration(t.duration)}},playClip:function(e){if(this.mixer){var t,n=this.data,o=this.model,r=o.animations||(o.geometry||{}).animations||[];if(r.length){if(t=e===i?r[0]:THREE.AnimationClip.findByName(r,n.clip),!t)return void console.error('[animation-mixer] Clip "%s" not found.',n.clip);this.activeAction=this.mixer.clipAction(t,o),this.activeAction.play()}}},tick:function(e,t){this.mixer&&!isNaN(t)&&this.mixer.update(t/1e3)}}},{}],4:[function(e,t,n){t.exports={"animation-mixer":e("./animation-mixer"),"json-model":e("./json-model"),"object-model":e("./object-model"),"ply-model":e("./ply-model"),"three-model":e("./three-model"),registerAll:function(e){this._registered||(e=e||window.AFRAME,e.components["animation-mixer"]||e.registerComponent("animation-mixer",this["animation-mixer"]),e.systems["ply-model"]||e.registerSystem("ply-model",this["ply-model"].System),e.components["ply-model"]||e.registerComponent("ply-model",this["ply-model"].Component),e.components["json-model"]||e.registerComponent("json-model",this["json-model"]),e.components["object-model"]||e.registerComponent("object-model",this["object-model"]),e.components["three-model"]||e.registerComponent("three-model",this["three-model"]),this._registered=!0)}}},{"./animation-mixer":3,"./json-model":5,"./object-model":6,"./ply-model":7,"./three-model":8}],5:[function(e,t,n){t.exports={schema:{src:{type:"src"},crossorigin:{"default":""}},init:function(){this.model=null},update:function(){var e,t=this.data;t.src&&(this.remove(),e=new THREE.JSONLoader,t.crossorigin&&(e.crossOrigin=t.crossorigin),e.load(t.src,function(e,t){t.forEach(function(t){t.vertexColors=(e.faces[0]||{}).color?THREE.FaceColors:THREE.NoColors,t.skinning=!!(e.bones||[]).length,t.morphTargets=!!(e.morphTargets||[]).length,t.morphNormals=!!(e.morphNormals||[]).length});var n=(e.bones||[]).length?new THREE.SkinnedMesh(e,new THREE.MultiMaterial(t)):new THREE.Mesh(e,new THREE.MultiMaterial(t));this.load(n)}.bind(this)))},load:function(e){this.model=e,this.el.setObject3D("mesh",e),this.el.emit("model-loaded",{format:"json",model:e})},remove:function(){this.model&&this.el.removeObject3D("mesh")}}},{}],6:[function(e,t,n){t.exports={schema:{src:{type:"src"},crossorigin:{"default":""}},init:function(){this.model=null},update:function(){var e,t=this.data;t.src&&(this.remove(),e=new THREE.ObjectLoader,t.crossorigin&&e.setCrossOrigin(t.crossorigin),e.load(t.src,function(e){e.traverse(function(e){e instanceof THREE.SkinnedMesh&&e.material&&(e.material.skinning=!!(e.geometry&&e.geometry.bones||[]).length)}),this.load(e)}.bind(this)))},load:function(e){this.model=e,this.el.setObject3D("mesh",e),this.el.emit("model-loaded",{format:"json",model:e})},remove:function(){this.model&&this.el.removeObject3D("mesh")}}},{}],7:[function(e,t,n){function i(e){return new THREE.Mesh(e,new THREE.MeshPhongMaterial({color:16777215,shading:THREE.FlatShading,vertexColors:THREE.VertexColors,shininess:0}))}THREE.PLYLoader=e("../../lib/PLYLoader"),t.exports.System={init:function(){this.cache={}},getOrLoadGeometry:function(e,t){var n=this.cache,i=n[e];return!t&&i?i:(n[e]=new Promise(function(t){var n=new THREE.PLYLoader;n.load(e,function(e){t(e)})}),n[e])}},t.exports.Component={schema:{skipCache:{type:"boolean","default":!1},src:{type:"src"}},init:function(){this.model=null},update:function(){var e=this.data,t=this.el;return e.src?void this.system.getOrLoadGeometry(e.src,e.skipCache).then(function(e){var n=i(e);t.setObject3D("mesh",n),t.emit("model-loaded",{format:"ply",model:n})}):void console.warn("[%s] `src` property is required.",this.name)},remove:function(){this.model&&this.el.removeObject3D("mesh")}}},{"../../lib/PLYLoader":2}],8:[function(e,t,n){var i="__auto__";t.exports={deprecated:!0,schema:{src:{type:"src"},loader:{"default":"object",oneOf:["object","json"]},enableAnimation:{"default":!0},animation:{"default":i},animationDuration:{"default":0},crossorigin:{"default":""}},init:function(){this.model=null,this.mixer=null,console.warn("[three-model] Component is deprecated. Use json-model or object-model instead.")},update:function(e){e=e||{};var t,n=this.data;if(!n.src)return void this.remove();if(Object.keys(e).length){var i=this.model&&this.model.activeAction;if(n.animation!==e.animation)return i&&i.stop(),void this.playAnimation();i&&n.enableAnimation!==i.isRunning()&&(n.enableAnimation?this.playAnimation():i.stop()),i&&n.animationDuration&&i.setDuration(n.animationDuration)}else if(this.remove(),"object"===n.loader)t=new THREE.ObjectLoader,n.crossorigin&&t.setCrossOrigin(n.crossorigin),t.load(n.src,function(e){e.traverse(function(t){t instanceof THREE.SkinnedMesh&&(e=t)}),e.material&&(e.material.skinning=!!(e.geometry&&e.geometry.bones||[]).length),this.load(e)}.bind(this));else{if("json"!==n.loader)throw new Error('[three-model] Invalid mode "%s".',n.mode);t=new THREE.JSONLoader,n.crossorigin&&(t.crossOrigin=n.crossorigin),t.load(n.src,function(e,t){t.forEach(function(t){t.vertexColors=(e.faces[0]||{}).color?THREE.FaceColors:THREE.NoColors,t.skinning=!!(e.bones||[]).length,t.morphTargets=!!(e.morphTargets||[]).length,t.morphNormals=!!(e.morphNormals||[]).length});var n=(e.bones||[]).length?new THREE.SkinnedMesh(e,new THREE.MultiMaterial(t)):new THREE.Mesh(e,new THREE.MultiMaterial(t));this.load(n)}.bind(this))}},load:function(e){this.model=e,this.mixer=new THREE.AnimationMixer(this.model),this.el.setObject3D("mesh",e),this.el.emit("model-loaded",{format:"three",model:e}),this.data.enableAnimation&&this.playAnimation()},playAnimation:function(){var e,t=this.data,n=this.model.animations||this.model.geometry.animations||[];if(t.enableAnimation&&t.animation&&n.length){if(e=t.animation===i?n[0]:THREE.AnimationClip.findByName(n,t.animation),!e)return void console.error('[three-model] Animation "%s" not found.',t.animation);this.model.activeAction=this.mixer.clipAction(e,this.model),t.animationDuration&&this.model.activeAction.setDuration(t.animationDuration),this.model.activeAction.play()}},remove:function(){this.mixer&&this.mixer.stopAllAction(),this.model&&this.el.removeObject3D("mesh")},tick:function(e,t){this.mixer&&!isNaN(t)&&this.mixer.update(t/1e3)}}},{}]},{},[1]);